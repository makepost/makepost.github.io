---
title: Вертикальні фрагменти
author: makepost
date: 2017-09-04 15:25
template: article.jade
---

Сайти зручно на вищому рівні організовувати з компонентів. В свою чергу, кожен компонент містить властиві лише йому логіку й стилі, сервіси й контролери тощо. Такий розподіл відповідальності (separation of concern) відповідає принципу [вертикальних фрагментів](https://speakerdeck.com/didoo/let-there-be-peace-on-css?slide=58), що використовується в гнучкій розробці.

<span class="more"></span>

Розглянемо можливу файлову структуру головної сторінки сайту. Сторінка подібна до лендінгу, містить кнопки з анімацією по наведенню, список із кастомним дизайном нумерації, модальне вікно з формою і відгуки користувачів.

```
# Не ок

button.html
index.html
list.html
list-item.html
main.js (50 КБ)
modal.html
post.html
style.css (1 000 рядків)
```

Розмітка `index` коректно поділена на компоненти: `button`, `modal`, `list`, `list-item`, `post`. Проте стилі зібрані в одному файлі `style.css`, а вся логіка знаходиться у `main.js`, що порушує принцип вертикальних фрагментів.

Щоб редагувати, наприклад, анімацію кнопки, доведеться знаходити її звичайні та адаптивні стилі в різних місцях style.css і змінювати її логіку в main.js. Виникатимуть конфлікти, коли ті самі файли редагують кілька розробників, працюючи над різними компонентами.

```
# Також не ок

css/button.css
css/index.css
css/list.css
css/list-item.css
css/modal.css
css/post.css
html/button.html
html/index.html
html/list.html
html/list-item.html
html/modal.html
html/post.html
js/button.js
js/main.js
js/modal.js
js/post.js
responsive/mobile.css
responsive/tablet.css
```

Розробникам із досвідом .NET MVC або Rails також може бути незвичним принцип вертикальних фрагментів. Маючи окремі теки для моделей, видів, контролерів, сервісів тощо, вони можуть спершу намагатися групувати файли за технологією. Адаптивні стилі для кожного пристрою розміщені в окремому файлі.

Для того ж редагування кнопки, потрібно відкрити теки `css/`, `js/`, `html/` і `responsive/`, знайти `button.css`, `button.js`, `button.html` і адаптив кнопки у `mobile.css` і `tablet.css`. Код одного компонента розміщений у п'яти файлах, що знаходяться в чотирьох різних теках. Коли ми маємо справу з типовим сайтом на 20-30 сторінок, файли одного компонента в різних теках уже навіть не вміщаються в сайдбарі редактора.


```
# Ок

button/button.css
button/button.html
button/button.js
index/index.css
index/index.html
list/list.css
list/list.html
list-item/list-item.css
list-item/list-item.html
modal/modal.css
modal/modal.html
modal/modal.js
post/post.css
post/post.html
```

Розміщуючи для кожного компонента всі його ресурси в окремій теці, уникаємо описаних вище проблем.

Адаптив елемента доцільно розміщувати прямо поруч із рештою його стилів, тоді все оформлення одного елемента зручно редагувати в одному місці:

```
body {
  background: red;
}

@media (min-width: 576px) {
  body {
    background: green;
  }
}

@media (min-width: 992px) {
  body {
    background: green;
  }
}

.Header {
  background: red;
  height: 50px;
}

@media (min-width: 576px) {
  .Header {
    height: 75px;
  }
}

@media (min-width: 992px) {
  .Header {
    height: 100px;
  }
}
```

Коли організація коду [відображає призначення](http://ryanlanciaux.com/blog/2017/08/20/a-feature-based-approach-to-react-development/), то легше знаходити файли і розуміти, що з чим пов'язане. Очевидна роль фрагменту коду в структурі застосунку.

Легше рефакторити, вводити фічі в експлуатацію і за потреби їх вимикати. Якщо функціонал має єдину точку входу, то видалення його не матиме великого впливу на решту системи.

Зміни до відгуку не зашкодять кнопці, і навпаки. Щоб прибрати сторінку сайту, достатньо видалити її теку та теки використаній лише на ній компонентів - з можливістю згодом так само їх повернути через систему контролю версій.

Уявляйте сайти як зв'язки ізольованих компонентів, по аналогії з філософією Юнікс. Окремі один від одного *блоки функціоналу* зосереджені на одній цілі й виконують її як слід.